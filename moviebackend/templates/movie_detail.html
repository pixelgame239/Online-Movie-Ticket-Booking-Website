{% extends "base.html" %}
{% load static %}
{% load tz %}

{% block title %}{{ movie.title }} - R·∫°p Vi·ªát Nam{% endblock %}

{% block content %}
<div class="container" style="margin:40px auto; max-width:1200px;">

  <h2 style="margin-bottom:20px;">N·ªôi Dung Phim</h2>
  <hr>

  <div style="display:flex; gap:30px; align-items:flex-start;">
    <!-- C·ªôt tr√°i: Th√¥ng tin phim -->
    <div style="flex:3;">
      <div style="display:flex; gap:30px; align-items:flex-start;">
        <!-- Poster -->
        <div style="flex:0 0 250px; text-align:center;">
          {% if movie.poster %}
            <img src="{{ movie.poster }}" alt="{{ movie.title }}" style="width:100%; max-width:250px; border:1px solid #ccc; padding:4px;">
          {% else %}
            <img src="{% static 'images/placeholder_movie.png' %}" alt="No Poster" style="width:100%; max-width:250px; border:1px solid #ccc; padding:4px;">
          {% endif %}
        </div>

        <!-- Th√¥ng tin phim -->
        <div style="flex:1;">
          <h3>{{ movie.title }}</h3>
          <table style="width:100%; border-collapse:collapse; margin:15px 0;">
            <tr>
              <td style="font-weight:bold;">Th·ªÉ lo·∫°i:</td>
              <td>{{ movie.genre.genre_name }}</td>
            </tr>
            <tr>
              <td style="font-weight:bold;">Kh·ªüi chi·∫øu:</td>
              <td>{{ movie.release_date|date:"d/m/Y" }}</td>
            </tr>
            <tr>
              <td style="font-weight:bold;">Th·ªùi l∆∞·ª£ng:</td>
              <td>{{ movie.duration }} ph√∫t</td>
            </tr>

            <tr>
              <td style="font-weight:bold;">Rated:</td>
              <td><span class="rating-badge">{{ movie.rating|default:"T13" }}</span></td>
            </tr>
          </table>
        </div>
      </div>

      <!-- L·ªãch chi·∫øu -->
      <div id="lich-chieu" style="margin-top:40px;">
        <h3>L·ªãch chi·∫øu</h3>
        {% if has_future_showtime %}
          <ul style="list-style:none; padding:0;">
            {% for s in future_showtimes %}
              <li style="margin-bottom:10px;">
                <strong>{{ s.cinema.name }}</strong> - {{ s.show_time|date:"d/m/Y H:i" }}
                <a href="{% url 'bookings:select_seats' s.id %}" class="btn-buy" style="margin-left:10px; padding:6px 12px;">MUA V√â</a>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p style="font-style:italic; color:gray;">Hi·ªán ch∆∞a c√≥ l·ªãch chi·∫øu cho phim n√†y.</p>
        {% endif %}
      </div>

      <!-- M√¥ t·∫£ -->
      <div style="margin-top:30px; text-align:center;">
        <a href="#" class="btn-detail">Chi ti·∫øt phim</a>
        <p style="margin-top:20px; line-height:1.6; text-align:justify;">
          {{ movie.description|default:"Hi·ªán ch∆∞a c√≥ m√¥ t·∫£ cho phim n√†y." }}
        </p>
      </div>
    </div>

    <!-- C·ªôt ph·∫£i: Phim c√πng th·ªÉ lo·∫°i -->
    <div style="flex:1; border-left:1px solid #ddd; padding-left:20px;">
      <h4 style="margin-bottom:15px;">üé¨ Phim c√πng th·ªÉ lo·∫°i</h4>
      {% if related_movies %}
        <ul style="list-style:none; padding:0; margin:0;">
          {% for rm in related_movies %}
            <li style="margin-bottom:15px;">
              <a href="{% url 'movies:movie_detail' rm.id %}" style="text-decoration:none; color:#000; display:flex; gap:10px; align-items:center;">
                {% if rm.poster %}
                  <img src="{{ rm.poster }}" alt="{{ rm.title }}" style="width:60px; height:90px; object-fit:cover; border:1px solid #ccc;">
                {% else %}
                  <img src="{% static 'images/placeholder_movie.png' %}" alt="No Poster" style="width:60px; height:90px; object-fit:cover; border:1px solid #ccc;">
                {% endif %}
                <span>{{ rm.title }}</span>
              </a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>Ch∆∞a c√≥ phim n√†o c√πng th·ªÉ lo·∫°i.</p>
      {% endif %}
    </div>
  </div>
</div>

<style>
.btn-buy {
  display:inline-block;
  background:#e50914;
  color:white;
  padding:10px 25px;
  border-radius:4px;
  font-weight:bold;
  text-decoration:none;
}
.btn-buy:hover { background:#b20710; }

.btn-detail {
  display:inline-block;
  background:#e50914;
  color:white;
  padding:10px 25px;
  border-radius:4px;
  font-weight:bold;
  text-decoration:none;
}
.btn-detail:hover { background:#b20710; }

.rating-badge {
  display:inline-block;
  padding:4px 10px;
  background:#d9f97d;
  border-radius:4px;
  font-weight:bold;
}
</style>
{% endblock %}
