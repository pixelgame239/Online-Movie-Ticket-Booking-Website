{% extends "base.html" %}
{% load static %}

{% block title %}Chi tiết tài khoản - Rạp Việt Nam{% endblock %}

{% block content %}
<style>
  .profile-container {
    display: flex;
    max-width: 1200px;
    width: auto;
    margin: 40px auto;
    gap: 40px;
    align-items: stretch;
  }

  /* Sidebar */
  .profile-sidebar {
    width: 250px;
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .profile-sidebar button {
    background: #E5E5E5;
    border: none;
    padding: 12px;
    font-size: 16px;
    text-align: left;
    cursor: pointer;
    width: 100%; 
  }

  .profile-sidebar .active {
    background: #E52025;
    color: white;
    font-weight: bold;
  }

  /* Main content */
  .profile-main {
    flex: 1;
  }

  .profile-main h2 {
    background: #000;
    color: #fff;
    padding: 10px;
    margin-bottom: 20px;
  }

  .edit-form {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px 30px;
    font-size: 15px;
  }

  .edit-form label {
    font-weight: bold;
    display: block;
    margin-bottom: 6px;
  }

  .edit-form input,
  .edit-form select,
  .edit-form textarea {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .edit-form .full-width {
    grid-column: span 2;
  }

  .gender-options {
    display: flex;
    gap: 15px;
    align-items: center;
    margin-top: 8px;
  }

  .submit-btn {
    margin-top: 20px;
    background: #E52025;
    color: white;
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 4px;
    font-size: 16px;
  }
</style>

<div class="profile-container">
  <!-- Sidebar -->
  <div class="profile-sidebar">
    <a href="{% url 'users:profile' %}"><button >THÔNG TIN CHUNG</button></a>
    <a href="{% url 'users:profile_edit' %}"><button class="active">CHI TIẾT TÀI KHOẢN</button></a>
    <a href="{% url 'users:password_change' %}"><button >CÀI ĐẶT MẬT KHẨU</button></a>
    <a href="{% url 'bookings:my_tickets' %}" ><button>LỊCH SỬ GIAO DỊCH</button></a>
  </div>

  <!-- Main content -->
  <div class="profile-main">
    <h2>THAY ĐỔI THÔNG TIN</h2>
    <!-- Thông báo -->
    {% if messages %}
      <div class="messages">
        {% for message in messages %}
          <div class="{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      </div>
    {% endif %}
    <form method="post" enctype="multipart/form-data" class="edit-form">
      {% csrf_token %}

      <div>
        <label for="id_username">Tên</label>
        {{ form.username }}
      </div>

      <div>
        <label for="id_phone">Điện thoại</label>
        {{ form.phone }}
      </div>

      <div class="full-width">
        <label for="id_address">Địa chỉ</label>
        {{ form.address }}
      </div>

      <div>
        <label>Giới tính</label>
        <div class="gender-options">
          <input type="radio" name="gender" value="M" {% if user.gender == 'M' %}checked{% endif %}> Nam
          <input type="radio" name="gender" value="F" {% if user.gender == 'F' %}checked{% endif %}> Nữ
        </div>
      </div>

      <div>
        <label for="id_birth_date">Ngày sinh</label>
        <input type="date" name="birth_date" id="id_birth_date"
               value="{{ user.birth_date|date:'Y-m-d' }}">
      </div>

      <div>
        <label for="id_email">Địa chỉ email</label>
        {{ form.email }}
      </div>

      <div>
        <label for="id_favorite_cinema">Rạp yêu thích</label>
        <select name="favorite_cinema" id="id_favorite_cinema">
          <option value="">-- Chọn rạp --</option>
          {% for cinema in cinemas %}
            <option value="{{ cinema.id }}" {% if user.favorite_cinema and user.favorite_cinema.id == cinema.id %}selected{% endif %}>
              {{ cinema.name }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label for="id_avatar">Ảnh đại diện</label>
        {{ form.upload_avatar }}
        {% if user.avatar %}
          <br>
          <img src="{{ user.avatar }}" alt="avatar hiện tại"
               style="width:100px; height:100px; object-fit:cover; border-radius:50%; margin-top:10px;">
        {% endif %}
      </div>

      <div class="full-width">
        <button type="submit" class="submit-btn">Lưu lại</button>
      </div>
    </form>
  </div>
</div>

{% endblock %}
